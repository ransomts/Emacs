#+title: dotfile configuration
#+author: Ransom
#+startup: hideall

* bashrc

#+BEGIN_SRC sh :tangle ~/.bashrc :comments both :noweb yes
<<bashrc-global-definitions>>

<<bashrc-spelling-mistakes>>

<<bashrc-colors>>

<<bashrc-bash4>>

<<bashrc-fuck>>

#<<bashrc-readline>>

#<<autostart-x>>
#+END_SRC

#+name: bashrc-global-definitions
#+BEGIN_SRC sh
if [ -f /etc/bashrc ]; then
	. /etc/bashrc
fi
#+END_SRC

#+name: bashrc-spelling-mistakes
#+BEGIN_SRC sh
alias ls='ls -h --color=always'
alias sl=ls
alias l=ls
alias ll='ls -alh'
alias la='ls -ah'
alias c=cd
alias cd..='cd ..'
alias ..='cd ..'
alias m=make
alias mr='make run'
alias maek=make
alias amek=make
alias amke=make
alias mcm="make clean && make"
alias mc="make clean"
alias grep='grep --color=auto'
alias dirs='dirs -v'
alias r='reset'
alias feh='feh --scale-down --image-bg black'
alias slack-term='slack-term -config .config/slack-term.json'
alias mysql='mysql -p'
alias make="make -j"
#+END_SRC

I like pretty colors
#+name: bashrc-colors
#+BEGIN_SRC sh
# At the prompt
export PS1="\[$(tput sgr0)\]\[\033[38;5;51m\]\h\[$(tput sgr0)\]\[\033[38;5;15m\] \[$(tput sgr0)\]\[\033[38;5;51m\]\A\[$(tput sgr0)\]\[\033[38;5;15m\] \[$(tput sgr0)\]\[\033[38;5;51m\]\W\[$(tput sgr0)\]\[\033[38;5;84m\]\\$\[$(tput sgr0)\]\[\033[38;5;15m\] \[$(tput sgr0)\]"
# and in the man pages
export LESS_TERMCAP_mb=$'\E[01;31m'
export LESS_TERMCAP_md=$'\E[01;31m'
export LESS_TERMCAP_me=$'\E[0m'
export LESS_TERMCAP_se=$'\E[0m'
export LESS_TERMCAP_so=$'\E[01;44;33m'
export LESS_TERMCAP_ue=$'\E[0m'
export LESS_TERMCAP_us=$'\E[01;32m'

export EDITOR='emacsclient'
export HISTFILE='/home/tsranso/.config/bash_history'

export MAKEFLAGS='-j'
#+END_SRC

Enable the useful Bash 4 features:
 - autocd, no need to type 'cd' when changing directory
 - cdspell, automatically fix directory typos when changing directory
 - direxpand, automatically expand directory globs when completing
 - dirspell, automatically fix directory typos when completing
 - globstar, ** recursive glob
 - histappend, append to history, don't overwrite
 - nocaseglob, case-insensitive globbing
#+name: bashrc-bash4
#+BEGIN_SRC sh
shopt -s autocd cdspell direxpand dirspell globstar histappend nocaseglob
#+END_SRC

#+name: bashrc-fuck
#+BEGIN_SRC sh
eval $(thefuck --alias)
#+END_SRC

readline variables and bindings
#+name: bashrc-readline
#+BEGIN_SRC sh
bind 'set completion-ignore-case on'
bind 'set completion-prefix-display-length 2'
bind 'set completion-map-case on'
bind 'set show-all-if-ambiguous on'
bind 'set show-all-if-unmodified on'
#+END_SRC

I want to autostart X from bash when I'm on tengen
#+name: autostart-x
#+BEGIN_SRC sh
  if [[ ! $DISPLAY && $XDG_VTNR -eq 1 ]]; then
      exec xinit
  fi
#+END_SRC
* gitconfig

#+BEGIN_SRC conf :tangle ~/.gitconfig :comments both
[user]
	email = tsranso@g.clemson.edu
	name = Tim Ransom
#+END_SRC

* sbclrc

#+BEGIN_SRC common-lisp :tangle ~/.sbclrc :comments both
;;; The following lines added by ql:add-to-init-file:
#-quicklisp
(let ((quicklisp-init (merge-pathnames "quicklisp/setup.lisp"
                                       (user-homedir-pathname))))
  (when (probe-file quicklisp-init)
    (load quicklisp-init)))
#+END_SRC

* X
** Xresources

#+BEGIN_SRC conf :tangle ~/.Xresources
! X colors.
! Generated by 'wal'

XTerm*foreground:   #FCFEF6
*background:   #010100
XTerm*background:   #010100
XTerm*cursorColor:  #FCFEF6

! Colors 0-15.
*.color0: #010100
*color0:  #010100
*.color1: #38B1C6
*color1:  #38B1C6
*.color2: #F3F48E
*color2:  #F3F48E
*.color3: #FEFEB1
*color3:  #FEFEB1
*.color4: #A2D0D3
*color4:  #A2D0D3
*.color5: #FDFDD4
*color5:  #FDFDD4
*.color6: #D1EBE9
*color6:  #D1EBE9
*.color7: #FCFEF6
*color7:  #FCFEF6
*.color8: #666666
*color8:  #666666
*.color9: #38B1C6
*color9:  #38B1C6
*.color10: #F3F48E
*color10:  #F3F48E
*.color11: #FEFEB1
*color11:  #FEFEB1
*.color12: #A2D0D3
*color12:  #A2D0D3
*.color13: #FDFDD4
*color13:  #FDFDD4
*.color14: #D1EBE9
*color14:  #D1EBE9
*.color15: #FCFEF6
*color15:  #FCFEF6

! Black color that will not be affected by bold highlighting.
*.color66: #010100
*color66:  #010100

! Rofi colors.
rofi.color-window: #010100, #010100, #F3F48E
rofi.color-normal: #010100, #FCFEF6, #010100, #F3F48E, #010100
rofi.color-active: #010100, #FCFEF6, #010100, #F3F48E, #010100
rofi.color-urgent: #010100, #38B1C6, #010100, #38B1C6, #FCFEF6

! Xclock colors.
XClock*foreground: #FCFEF6
XClock*background: #010100
XClock*majorColor:  rgba:fc/fe/f6/ff
XClock*minorColor:  rgba:fc/fe/f6/ff
XClock*hourColor:   rgba:fc/fe/f6/ff
XClock*minuteColor: rgba:fc/fe/f6/ff
XClock*secondColor: rgba:fc/fe/f6/ff

#+END_SRC

** Xmodmap

#+BEGIN_SRC conf :tangle ~/.Xmodmap :comments no
clear lock
clear control
add control = Caps_Lock Control_L Control_R
keycode 66 = Control_L Caps_Lock NoSymbol NoSymbol

! keycode 64 = Alt_L
! keycode 133 = Super_L
! remove Mod1 = Alt_L
! remove Mod4 = Super_L
! add Mod1 = Super_L
! add Mod4 = Alt_L

! keycode 108 = Alt_R
! keycode 134 = Super_R
! remove Mod1 = Alt_R
! remove Mod4 = Super_R
! add Mod1 = Super_R
! add Mod4 = Alt_R
#+END_SRC

** xinitrc

#+BEGIN_SRC sh :tangle ~/.xinitrc :comments both :shebang #!/bin/sh
userresources=$HOME/.Xresources
usermodmap=$HOME/.Xmodmap
sysresources=/etc/X11/xinit/.Xresources
sysmodmap=/etc/X11/xinit/.Xmodmap

export _JAVA_AWT_WM_NONREPARENTING=1

# merge in defaults and keymaps

if [ -f $sysresources ]; then
    xrdb -merge $sysresources
fi

# Because I let wpg handle .Xresources for color,
# I'm loading in this to configure urxvt perl behavior
xrdb -merge /home/tsranso/.config/urxvt/conf

if [ -f $sysmodmap ]; then
    xmodmap $sysmodmap
fi

if [ -f "$userresources" ]; then
    xrdb -merge "$userresources"
fi

if [ -f "$usermodmap" ]; then
    xmodmap "$usermodmap"
fi

# start some nice programs
if [ -d /etc/X11/xinit/xinitrc.d ] ; then
 for f in /etc/X11/xinit/xinitrc.d/?*.sh ; do
  [ -x "$f" ] && . "$f"
 done
 unset f
fi

/home/tsranso/.screenlayout/tengen.sh
#tablet_id=$(xinput list --long | grep 'Pen Pen' | grep -o "id.*" | cut -f 1 | sed 's/id=//')
#xinput map-to-output $tablet_id HDMI-3

# MPD daemon start (if no other user instance exists)
#[ ! -s ~/.config/mpd/pid ] && mpd &

export scrot_dir=/home/tsranso/Pictures
export scrot_name="neofetch-$(date +%F-%I-%M-%S-${RANDOM}).png"
export RTV_BROWSER=google-chrome-stable
export VISUAL=emacsclient
export EDITOR="$VISUAL"
export DESKTOP_SESSION=gnome

# these should be run before emacs starts to get the X session kicked off
[ -f /usr/local/etc/profile.d/autojump.sh ] && . /usr/local/etc/profile.d/autojump.sh
setxkbmap -layout dvorak -option ctrl:nocaps 
numlockx on

export DESKTOP_SESSION=exwm ; exec dbus-launch --exit-with-session emacs -geometry 180x60
#exec cinnamon

#exec gnome-session
#exec awesome >> ~/.cache/awesome/stdout 2>> ~/.cache/awesome/stderr
#exec i3
#exec /usr/bin/stumpwm
#+END_SRC

* mailcap

#+BEGIN_SRC conf :tangle ~/.mailcap :comments both
# Example mailcap file for Reddit Terminal Viewer
# https://github.com/michael-lazar/rtv/
#
# Copy the contents of this file to {HOME}/.mailcap, or point to it using $MAILCAPS
# Then launch RTV using the --enable-media flag. All shell commands defined in
# this file depend on external programs that must be installed on your system.
#
# HELP REQUESTED! If you come up with your own commands (especially for OS X)
# and would like to share, please post an issue on the GitHub tracker and we
# can get them added to this file as references.
#
#
#                              Mailcap 101
# - The first entry with a matching MIME type will be executed, * is a wildcard
# - %s will be replaced with the image or video url
# - Add ``test=test -n "$DISPLAY"`` if your command opens a new window
# - Add ``needsterminal`` for commands that use the terminal
# - Add ``copiousoutput`` for commands that dump text to stdout

###############################################################################
# Commands below this point will open media in a separate window without
# pausing execution of RTV.
###############################################################################

# Feh is a simple and effective image viewer
# Note that rtv returns a list of urls for imgur albums, so we don't put quotes
# around the `%s`
image/x-imgur-album; feh -B 'black' -Z %s; test=test -n "$DISPLAY"
image/gif; mpv '%s' --autofit 640x480 --loop=inf; test=test -n "$DISPLAY"
image/*; feh  -B 'black' -Z '%s'; test=test -n "$DISPLAY"

# Youtube videos are assigned a custom mime-type, which can be streamed with
# vlc or youtube-dl.
video/x-youtube; mpv --ytdl-format=bestvideo+bestaudio/best '%s' --autofit 640x480; test=test -n "$DISPLAY"
video/x-youtube; vlc '%s' --width 640 --height 480; test=test -n "$DISPLAY"

# Mpv is a simple and effective video streamer
video/*; mpv '%s' --autofit 640x480 --loop=inf; test=test -n "$DISPLAY"

###############################################################################
# Commands below this point will attempt to display media directly in the
# terminal when a desktop is not available (e.g. inside of an SSH session)
###############################################################################

# View images directly in your terminal with iTerm2
# curl -L https://iterm2.com/misc/install_shell_integration_and_utilities.sh | bash
# image/*; curl -s %s | ~/.iterm2/imgcat && read -n 1; needsterminal

# View true images in the terminal, supported by rxvt-unicode, xterm and st
# Requires the w3m-img package
# image/*; w3m -o 'ext_image_viewer=off' '%s'; needsterminal

# Don't have a solution for albums yet
image/x-imgur-album; echo

# 256 color images using half-width unicode characters
# Much higher quality that img2txt, but must be built from source
# https://github.com/rossy/img2xterm
image/*; curl -s '%s' | convert -resize 80x80 - jpg:/tmp/rtv.jpg && img2xterm /tmp/rtv.jpg; needsterminal; copiousoutput

# Display images in classic ascii using img2txt and lib-caca
image/*; curl -s '%s' | convert - jpg:/tmp/rtv.jpg && img2txt -f utf8 /tmp/rtv.jpg; needsterminal; copiousoutput

# Full motion videos - requires a framebuffer to view
video/x-youtube; mpv -vo drm -quiet '%s'; needsterminal
video/*; mpv -vo drm -quiet '%s'; needsterminal

# Ascii videos
# video/x-youtube; youtube-dl -q -o - '%s' | mplayer -cache 8192 -vo caca -quiet -; needsterminal
# video/*; wget '%s' -O - | mplayer -cache 8192 -vo caca -quiet -; needsterminal
#+END_SRC

* urxvt
#+BEGIN_SRC txt :tangle ~/.config/urxvt/conf :mkdirp t
URxvt.perl-ext-common: default,matcher,tabbedex,url-select

URxvt.tabbed.autohide: true

URxvt.url-launcher: google-chrome-stable
URxvt.matcher.button: 1
URxvt.matcher.rend.0: Uline Bold fg5
URxvt.keysym.C-Delete: perl:matcher:last
URxvt.keysym.M-Delete: perl:matcher:list
URxvt.keysym.M-u: perl:url-select:select_next
URxvt.url-select.launcher: firefox
URxvt.url-select.underline: true


URxvt.font:     xft:bitstream vera sans mono:size=10:antialias=true
URxvt.boldFont: xft:bitstream vera sans mono:bold:size=10:antialias=true
! Set depth to make transparency work.
URxvt*depth: 32

URxvt.scrollBar: false

URxvt*foreground:   #FCFEF6
!URxvt*background:   [100]#010100
UXTerm*background:  #010100
URxvt*cursorColor:  #FCFEF6
!URxvt*borderColor:  [100]#010100
#+END_SRC

* rtv
#+BEGIN_SRC conf :tangle ~/.config/rtv/rtv.cfg :mkdirp t :comments both
; Reddit Terminal Viewer Configuration File
; https://github.com/michael-lazar/rtv
;
; This file should be placed in $XDG_CONFIG/rtv/rtv.cfg
; If $XDG_CONFIG is not set, use ~/.config/rtv/rtv.cfg

[rtv]
##################
# General Settings
##################

; Turn on ascii-only mode to disable all unicode characters.
; This may be necessary for compatibility with some terminal browsers.
ascii = False

; Turn on monochrome mode to disable color.
monochrome = False

; Enable debugging by logging all HTTP requests and errors to the given file.
;log = /tmp/rtv.log

; Default subreddit that will be opened when the program launches.
subreddit = front
;subreddit = python
;subreddit = python+linux+programming
;subreddit = all

; Allow rtv to store reddit authentication credentials between sessions.
persistent = True

; Clear any stored credentials when the program starts.
clear_auth = False

; Maximum number of opened links that will be saved in the history file.
history_size = 200

; Open external links using programs defined in the mailcap config.
enable_media = True

; Maximum number of columns for a comment
max_comment_cols = 120

; Hide username if logged in, display "Logged in" instead
hide_username = True

################
# OAuth Settings
################
; This sections defines the paramaters that will be used during the OAuth
; authentication process. rtv is registered as an "installed app",
; see https://github.com/reddit/reddit/wiki/OAuth2 for more information.

; These settings are defined at https://www.reddit.com/prefs/apps and should
; not be altered unless you are defining your own developer application.
oauth_client_id = E2oEtRQfdfAfNQ
oauth_client_secret = praw_gapfill
oauth_redirect_uri = http://127.0.0.1:65000/

; Port that the rtv webserver will listen on. This should match the redirect
; uri defined above.
oauth_redirect_port = 65000

; Access permissions that will be requested.
oauth_scope = edit,history,identity,mysubreddits,privatemessages,read,report,save,submit,subscribe,vote

; This is a separate token for the imgur api. It's used to extract images
; from imgur links and albums so they can be opened with mailcap.
; See https://imgur.com/account/settings/apps to generate your own key.
imgur_client_id = 93396265f59dec9

[bindings]
##############
# Key Bindings
##############
; If you would like to define custom bindings, copy this section into your
; config file with the [bindings] heading. All commands must be bound to at
; least one key for the config to be valid. 
;
; 1.) Plain keys can be represented by either uppercase/lowercase characters
;     or the hexadecimal numbers referring their ascii codes. For reference, see
;     https://en.wikipedia.org/wiki/ASCII#ASCII_printable_code_chart
;         e.g. Q, q, 1, ?
;         e.g. 0x20 (space), 0x3c (less-than sign)
;
; 2.) Special ascii control codes should be surrounded with <>. For reference,
;     see https://en.wikipedia.org/wiki/ASCII#ASCII_control_code_chart
;         e.g. <LF> (enter), <ESC> (escape)
;
; 3.) Other special keys are defined by curses, they should be surrounded by <>
;     and prefixed with KEY_. For reference, see
;     https://docs.python.org/2/library/curses.html#constants
;         e.g. <KEY_LEFT> (left arrow), <KEY_F5>, <KEY_NPAGE> (page down)
;
; Notes:
; - Curses <KEY_ENTER> is unreliable and should always be used in conjunction
;   with <LF>.
; - Use 0x20 for the space key.
; - A subset of Ctrl modifiers are available through the ascii control codes.
;   For example, Ctrl-D will trigger an <EOT> signal. See the table above for
;   a complete reference.

; Base page
EXIT = q 
FORCE_EXIT = Q
HELP = ?
SORT_HOT = 1
SORT_TOP = 2
SORT_RISING = 3
SORT_NEW = 4
SORT_CONTROVERSIAL = 5
MOVE_UP = k, <KEY_UP>
MOVE_DOWN = j, <KEY_DOWN>
PAGE_UP = m, <KEY_PPAGE>, <NAK>
PAGE_DOWN = <KEY_NPAGE>, <EOT>
PAGE_TOP = gg
PAGE_BOTTOM = G
UPVOTE = p
DOWNVOTE = n
LOGIN = u
DELETE = d
EDIT = e
INBOX = i
REFRESH = r, <KEY_F5>
PROMPT = /
SAVE = w
COPY_PERMALINK = y
COPY_URL = Y

; Submission page
SUBMISSION_TOGGLE_COMMENT = 0x20
SUBMISSION_OPEN_IN_BROWSER = o, <LF>, <KEY_ENTER>
SUBMISSION_POST = c
SUBMISSION_EXIT = h, <KEY_LEFT>
SUBMISSION_OPEN_IN_PAGER = l, <KEY_RIGHT>
SUBMISSION_OPEN_IN_URLVIEWER = b
SUBMISSION_GOTO_PARENT = K
SUBMISSION_GOTO_SIBLING = J

; Subreddit page
SUBREDDIT_SEARCH = f
SUBREDDIT_POST = c
SUBREDDIT_OPEN = l, <KEY_RIGHT>
SUBREDDIT_OPEN_IN_BROWSER = o, <LF>, <KEY_ENTER>
SUBREDDIT_OPEN_SUBSCRIPTIONS = s
SUBREDDIT_OPEN_MULTIREDDITS = S
SUBREDDIT_FRONTPAGE = p

; Subscription page
SUBSCRIPTION_SELECT = l, <LF>, <KEY_ENTER>, <KEY_RIGHT>
SUBSCRIPTION_EXIT = h, s, S, <ESC>, <KEY_LEFT>

#+END_SRC

